<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Teaching a Dumbphone New Tricks &#8211; Mapping Vermont</title>
<meta name="description" content="Building an SMS-based google maps client">
<meta name="keywords" content="dumbphone, AWS, javascript">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Teaching a Dumbphone New Tricks">
<meta property="og:description" content="Building an SMS-based google maps client">
<meta property="og:url" content="http://localhost:4000/web/2017/03/26/teaching-a-dumbphone-new-tricks/">
<meta property="og:site_name" content="Mapping Vermont">





<link rel="canonical" href="http://localhost:4000/web/2017/03/26/teaching-a-dumbphone-new-tricks/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Mapping Vermont Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">Mapping Vermont</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				<li><a href="http://localhost:4000/about/" >About</a></li>
		        
				<li><a href="http://localhost:4000/posts/" >Posts</a></li>
		        
				<li><a href="http://localhost:4000/projects/" >Projects</a></li>
		        
				<li><a href="http://localhost:4000/data/" >Data</a></li>
		        
				<li><a href="http://localhost:4000/resources/" >Resources</a></li>
		        
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="MappingVermont bio photo"></a>
<h3>MappingVermont</h3>
<p></p>





<a href="http://github.com/mappingvermont" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>



  </div>
  <article>
    <div class="headline-wrap">
      <h1>Teaching a Dumbphone New Tricks</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>I have a dumbphone. And it’s great, except when I’m lost. Most people open Google Maps on their phone, check out their location on the map, and course correct. I usually drive/hike/bike for another 15 minutes, then call one of my other dumbphone friends and ask them to look things up for me.
<br />
<br />
I’d been meaning to try <a href="https://aws.amazon.com/lambda/">AWS Lambda</a> for some time, and this seemed like a good application. AWS Lambda provides serverless computing infrastructure– you upload your code to the AWS servers, it waits for you to trigger it, and you only pay for it when it’s in use. Plus it’s totally scalable, so when this “app” takes over the dumbphone world, it should remain responsive.
<br />
<br />
In theory it’s pretty simple. The app needs to:</p>

<ul>
  <li>Get a text message with structured to/from/mode of transportation information</li>
  <li>Pass this to the Google Directions API</li>
  <li>Parse the response</li>
  <li>Return turn-by-turn directions by SMS to the phone</li>
</ul>

<p>As part of my year-long effort to improve my JavaScript skills, I wrote this in Node JS instead of my usual python. It took a little longer, but soon enough I could communicate with the Google API and return directions in a formatted text string:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">stepArr</span> <span class="o">=</span> <span class="p">[]</span>

<span class="kd">var</span> <span class="nx">steps</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">.</span><span class="nx">routes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">legs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">steps</span>
<span class="k">for </span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">steps</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="nx">steps</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
    <span class="kd">var</span> <span class="nx">instruction</span> <span class="o">=</span> <span class="nx">step</span><span class="p">.</span><span class="nx">html_instructions</span>
    <span class="kd">var</span> <span class="nx">distance</span> <span class="o">=</span> <span class="nx">step</span><span class="p">.</span><span class="nx">distance</span><span class="p">.</span><span class="nx">text</span>

    <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">instruction</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> (</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">distance</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">)</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">stepArr</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">return</span> <span class="nx">stepArr</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">, </span><span class="dl">'</span><span class="p">)</span></code></pre></figure>

<p>Now the hard part– hooking this process up to SMS and AWS. The <a href="http://www.perrygeo.com/running-python-with-compiled-code-on-aws-lambda.html">few things I’d read</a> about deployment suggested it was possible, but involved lots of bundling virtualenvs, handlers, workers in very specific ways so they could be invoked by AWS. <br />
<br />
Luckily I found <a href="https://www.twilio.com/blog/2016/12/create-an-sms-bot-on-aws-lambda-with-claudia-js.html">this awesome tutorial</a> from the SMS service Twilio, which made the process relatively painless. Per their recommendation I wrapped my code using the <a href="https://github.com/claudiajs/claudia-bot-builder">Claudia Bot Builder</a> package, and it took care of the rest, providing an easy CLI interface to package my code and upload it to Lambda.<br />
<br />
The only hard part, per always, my poor understanding of the async nature of JavaScript. I ultimately included calls to OSM’s nominatim geocoder as well, and waiting for responses to come back from that and Google Maps was tough. Once that process was sorted out, and all returned the Promise objects required by claudia.js, deploying was easy.<br />
<br />
I now have an SMS service that can text me directions when I’m lost, am a little bit better at writing JavaScript, and am excited to build more AWS Lambda functions. For those of you with dumbphones, get in touch and I’d be happy to share the phone number and input parameters for the service. For everyone else, check out the code on github to see how easy it is to write a Lambda function: <a href="http://github.com/mappingvermont/navigator">http://github.com/mappingvermont/navigator/</a>.</p>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="MappingVermont bio photo"></a>
<h3>MappingVermont</h3>
<p></p>





<a href="http://github.com/mappingvermont" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>



        </div>
        </footer>
    </div><!-- /.article-wrap -->
  </article>

</div><!-- /#main -->

<div class="footer-wrap">

  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/posts/">View all posts</a>)</small></h4>
    <ul>
    
      
      
      
      <li><a href="http://localhost:4000/web/2021/11/27/famous-vermonters/" title="Famous Vermonters">Famous Vermonters</a></li>
      
    
      
      
      
      <li><a href="http://localhost:4000/web/2017/10/09/vermont-town-tracker/" title="Vermont Town Tracker">Vermont Town Tracker</a></li>
      
    
      
      
      
      <li><a href="http://localhost:4000/web/2017/08/13/sanborn-chrome-extension/" title="A Sanborn Map For Every New Tab">A Sanborn Map For Every New Tab</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2023 MappingVermont. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>
	        

</body>
</html>
